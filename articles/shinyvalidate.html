<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to shinyvalidate • shinyvalidate</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to shinyvalidate">
<meta property="og:description" content="shinyvalidate">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">shinyvalidate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/shinyvalidate.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/advanced.html">Advanced validation</a>
    </li>
    <li>
      <a href="../articles/displaying.html">Displaying validation errors</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rstudio/shinyvalidate/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="shinyvalidate_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to shinyvalidate</h1>
                        <h4 class="author">Joe Cheng</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rstudio/shinyvalidate/blob/master/vignettes/shinyvalidate.Rmd"><code>vignettes/shinyvalidate.Rmd</code></a></small>
      <div class="hidden name"><code>shinyvalidate.Rmd</code></div>

    </div>

    
    
<p>When we present users of our apps with opportunities to input data, there’s often the possibility that they can input data incorrectly. They might leave a required input blank, or make a series of choices that make no sense in combination, or fill the “Email address” field with a value that is clearly not a valid email address.</p>
<p>In these cases, we want to provide feedback to the user that they’ve made a mistake.</p>
<p><img src="../man/figures/demo.gif" alt="Screencast of empty 'Name' and 'Email' fields showing error messages beneath them, and the user providing valid input that clears the errors" width="316"></p>
<div id="basic-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-usage" class="anchor"></a>Basic usage</h2>
<p>To add input validation to your app:</p>
<ol style="list-style-type: decimal">
<li><p>Create an <a href="https://rstudio.github.io/shinyvalidate/reference/InputValidator.html"><code>InputValidator</code></a> object (in this doc, we will usually name the variable <code>iv</code>).</p></li>
<li><p>Add one or more validation rules to <code>iv</code>.</p></li>
<li><p>Start displaying realtime feedback in the UI by calling <a href="https://rstudio.github.io/shinyvalidate/reference/InputValidator.html#method-enable-"><code>iv$enable()</code></a>.</p></li>
<li><p>Guard calculations and operations that rely on valid inputs, by checking that <code>iv$is_valid()</code> returns <code>TRUE</code>.</p></li>
</ol>
<p>Note that all of these steps must be performed in your Shiny app’s <code>server</code> function.</p>
<p>To see this in action, let’s look at the server function from the <code>01_simple</code> example app [<a href="https://github.com/rstudio/shinyvalidate/blob/master/inst/examples/01_simple/app.R">source</a>, <a href="https://jcheng.shinyapps.io/01_simple/">live demo</a>].</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span>

  <span class="co"># 1. Create an InputValidator object</span>
  <span class="va">iv</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/InputValidator.html">InputValidator</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>
  
  <span class="co"># 2. Add validation rules</span>
  <span class="va">iv</span><span class="op">$</span><span class="fu">add_rule</span><span class="op">(</span><span class="st">"name"</span>, <span class="fu"><a href="../reference/sv_required.html">sv_required</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="va">iv</span><span class="op">$</span><span class="fu">add_rule</span><span class="op">(</span><span class="st">"email"</span>, <span class="fu"><a href="../reference/sv_required.html">sv_required</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  <span class="va">iv</span><span class="op">$</span><span class="fu">add_rule</span><span class="op">(</span><span class="st">"email"</span>, <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">is_valid_email</span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="st">"Not a valid email"</span><span class="op">)</span>
  
  <span class="co"># 3. Start displaying errors in the UI</span>
  <span class="va">iv</span><span class="op">$</span><span class="fu">enable</span><span class="op">(</span><span class="op">)</span>
  
  <span class="va">output</span><span class="op">$</span><span class="va">greeting</span> <span class="op">&lt;-</span> <span class="fu">renderText</span><span class="op">(</span><span class="op">{</span>
    <span class="co"># 4. Don't proceed if any input is invalid</span>
    <span class="fu">req</span><span class="op">(</span><span class="va">iv</span><span class="op">$</span><span class="fu">is_valid</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
    
    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Nice to meet you, "</span>, <span class="va">input</span><span class="op">$</span><span class="va">name</span>, <span class="st">" &lt;"</span>, <span class="va">input</span><span class="op">$</span><span class="va">email</span>, <span class="st">"&gt;!"</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span>
<span class="op">}</span></pre></div>
<p>This validator has rules that check that a value is provided for <code>input$name</code> and <code>input$email</code>, and that the provided email is valid.</p>
</div>
<div id="adding-rules" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-rules" class="anchor"></a>Adding rules</h2>
<p>The most important part of the code above is the expression of validation rules via <code>add_rule()</code> calls. The function signature of <code>add_rule()</code> looks like this (minus the <code>session.</code> argument, which can generally be ignored):</p>
<pre><code>InputValidator$add_rule(inputId, rule, ...)</code></pre>
<p><code>inputId</code> should be a single-element character vector, with the ID of the input to be validated. Note that each call to <code>add_rule</code> must check the validness of one and only one input.</p>
<p>The <code>rule</code> argument can take various forms:</p>
<div id="rules-from-helper-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#rules-from-helper-functions" class="anchor"></a>Rules from helper functions</h3>
<p>For maximum convenience, shinyvalidate comes with a few helper functions that implement common validation rules. The <a href="https://rstudio.github.io/shinyvalidate/reference/sv_required.html"><code>sv_required</code></a> helper is likely to be the one you reach for most often:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="va">iv</span><span class="op">$</span><span class="fu">add_rule</span><span class="op">(</span><span class="st">"title"</span>, <span class="fu"><a href="../reference/sv_required.html">sv_required</a></span><span class="op">(</span>message <span class="op">=</span> <span class="st">"Title must be provided"</span><span class="op">)</span><span class="op">)</span></pre></div>
<p>The <code>message</code> argument is optional; if you omit it, the default message is simply “Required”. Keep in mind that validation error messages will be displayed next to the erroneous input, so it’s generally not strictly necessary for the error message to spell out which input it refers to.</p>
<p>Currently, shinyvalidate provides only a handful of validation helper functions. Besides <code>sv_required</code>, there’s also <a href="https://rstudio.github.io/shinyvalidate/reference/sv_numeric.html"><code>sv_numeric</code></a>, <a href="https://rstudio.github.io/shinyvalidate/reference/sv_numeric.html"><code>sv_integer</code></a>, and <a href="https://rstudio.github.io/shinyvalidate/reference/sv_regex.html"><code>sv_regex</code></a>; see their help topics for more information.</p>
</div>
<div id="rules-as-formulas" class="section level3">
<h3 class="hasAnchor">
<a href="#rules-as-formulas" class="anchor"></a>Rules as formulas</h3>
<p>If your validation logic differs from the helper functions described above, you can use a formula to implement custom rules.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="va">iv</span><span class="op">$</span><span class="fu">add_rule</span><span class="op">(</span><span class="st">"email"</span>, <span class="op">~</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu">is_valid_email</span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span> <span class="st">"Not a valid email"</span><span class="op">)</span></pre></div>
<p>Validation formulas should test the <code>.</code> variable, and return either <code>NULL</code> if the value is acceptable, or else a single-element character vector describing why the value is problematic.</p>
<p>(If you’re wondering why the formula in this example doesn’t end with <code>else NULL</code>, note that in R, <code>if</code> expressions automatically return <code><a href="https://rdrr.io/r/base/invisible.html">invisible(NULL)</a></code> when false and no <code>else</code> is present.)</p>
</div>
<div id="rules-as-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#rules-as-functions" class="anchor"></a>Rules as functions</h3>
<p>Finally, you can provide validation logic as a function.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="va">iv</span><span class="op">$</span><span class="fu">add_rule</span><span class="op">(</span><span class="st">"count"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">value</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span>
    <span class="st">"Negative values are not allowed"</span>
  <span class="op">}</span>
<span class="op">}</span><span class="op">)</span></pre></div>
<p>Functions receive the value to test as an argument (named <code>value</code> by convention), and should return <code>NULL</code> if that value is valid, and a single-element character vector with a descriptive message if the value is invalid.</p>
<p>Note that you can use named functions, not just anonymous ones; and that if the function takes additional arguments, these can be provided by passing <code>...</code> arguments to <code>iv$add_rule()</code>, similar to how <code>lapply</code> works. This example demonstrates both:</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="va">not_greater_than</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">value</span>, <span class="va">limit</span>, <span class="va">message</span> <span class="op">=</span> <span class="st">"Value is too high"</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">value</span> <span class="op">&gt;</span> <span class="va">limit</span><span class="op">)</span> <span class="va">message</span>
<span class="op">}</span>

<span class="va">iv</span><span class="op">$</span><span class="fu">add_rule</span><span class="op">(</span><span class="st">"samples"</span>, <span class="va">not_greater_than</span>, limit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>,
  message <span class="op">=</span> <span class="st">"Sample count cannot exceed number of rows"</span>
<span class="op">)</span></pre></div>
<p><strong>(TODO: make examples reproducible)</strong></p>
</div>
</div>
<div id="displaying-real-time-feedback" class="section level2">
<h2 class="hasAnchor">
<a href="#displaying-real-time-feedback" class="anchor"></a>Displaying real-time feedback</h2>
<p>Once you’ve created an <code>InputValidator</code> object and populated it with rules, shinyvalidate has the information it needs to check input values and report any problems it detects.</p>
<p>However, it doesn’t do so by default. Instead, you must call <code>iv$enable()</code> at least once to get validation errors to appear. Once <code>iv$enable()</code> has been called, though, validation messages will appear, update, and disappear reactively; there’s no need to call <code>enable()</code> as input values change.</p>
<p>The reason for this design is because many forms have an explicit “Submit” or “Continue” button, and in those cases, you may want to suppress the display of validation errors until the user actually attempts to submit the form. This is considered a better user experience than overwhelming the user with error messages before they’ve even started filling out the form.</p>
<p>To defer validation until “Submit” or “Continue” time, simply call <code>iv$enable()</code> from within whatever <code>observeEvent</code> or <code>eventReactive</code> is triggered by the submit/continue button. You can see this in the 02_deferred example [<a href="https://github.com/rstudio/shinyvalidate/blob/master/inst/examples/02_deferred/app.R">source</a>, <a href="https://jcheng.shinyapps.io/02_deferred/">live demo</a>].</p>
<p>If, on the other hand, your app doesn’t have a notion of “Submit” or “Continue”, then just go ahead and call <code>iv$enable()</code> as soon as your <code>InputValidator</code> object is populated with rules.</p>
</div>
<div id="guarding-calculations-and-actions" class="section level2">
<h2 class="hasAnchor">
<a href="#guarding-calculations-and-actions" class="anchor"></a>Guarding calculations and actions</h2>
<p>Besides displaying errors to the user, <code>InputValidator</code> can also help your observers and reactive expressions ensure they are only operating on complete and valid input (as defined by the rules you defined on the <code>InputValidator</code> object).</p>
<p>Currently, <code>InputValidator</code> exposes a single, simple <code>is_valid()</code> method that returns <code>TRUE</code> or <code>FALSE</code>. You can either use it in a simple conditional:</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu">observeEvent</span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">continue</span>, <span class="op">{</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">iv</span><span class="op">$</span><span class="fu">is_valid</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="co"># use inputs...</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="fu">showNotification</span><span class="op">(</span>
      <span class="st">"Please fix the errors in the form before continuing"</span>,
      type <span class="op">=</span> <span class="st">"warning"</span>
    <span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span><span class="op">)</span></pre></div>
<p>Or, if you don’t want to do anything besides silently abort the calculation/action/output, you can use <code>req(iv$is_valid())</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">reactive</span><span class="op">(</span><span class="op">{</span>
  <span class="fu">req</span><span class="op">(</span><span class="va">iv</span><span class="op">$</span><span class="fu">is_valid</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
  
  <span class="co"># use inputs...</span>
<span class="op">}</span><span class="op">)</span></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Joe Cheng,  RStudio.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
